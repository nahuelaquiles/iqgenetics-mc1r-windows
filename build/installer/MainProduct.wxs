<?xml version="1.0" encoding="utf-8"?>
<!--
  WiX v4 fragment-based installer for IQ Genetics MC1R.  We rely on the
  WixToolset.Sdk to generate the outer <Package> element using metadata
  defined in the .wixproj (ProductName, Manufacturer, PackageVersion,
  UpgradeCode).  This file defines directories, the start-menu shortcut,
  and the feature that pulls in the harvested published files.
-->
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <!-- Define the installation directories.  ProgramFiles6432Folder and
       ProgramMenuFolder are standard directory identifiers in WiX v4. -->
  <Fragment>
    <Directory Id="ProgramFiles6432Folder">
      <Directory Id="INSTALLFOLDER" Name="IQ Genetics MC1R Sanger Automation" />
    </Directory>
    <Directory Id="ProgramMenuFolder">
      <Directory Id="StartMenuFolder" Name="IQ Genetics MC1R Sanger Automation" />
    </Directory>
  </Fragment>

  <!-- Define the start-menu shortcut component.  This component creates
       a shortcut to the installed application and a registry value to
       mark installation for reference during uninstall. -->
  <Fragment>
    <Component Id="StartMenuShortcut" Directory="StartMenuFolder" Guid="D5774AA1-F836-4BF6-9205-DFC4F77D6751">
      <Shortcut Id="ApplicationStartMenuShortcut"
                Name="IQ Genetics MC1R Sanger Automation"
                Target="[INSTALLFOLDER]IQGenetics.MC1R.App.exe"
                WorkingDirectory="INSTALLFOLDER" />
      <RemoveFolder Id="RemoveStartMenuDir" On="uninstall" />
      <RegistryValue Root="HKCU"
                     Key="Software\\IQ Genetics / GECORP\\IQ Genetics MC1R Sanger Automation"
                     Name="Installed"
                     Type="integer"
                     Value="1"
                     KeyPath="yes" />
    </Component>
  </Fragment>

  <!-- Define the main feature that installs the harvested application files
       (PublishedFiles) and the start-menu shortcut component. -->
  <Fragment>
    <Feature Id="MainFeature" Title="IQ Genetics MC1R Sanger Automation" Level="1">
      <ComponentGroupRef Id="PublishedFiles" />
      <ComponentRef Id="StartMenuShortcut" />
    </Feature>
  </Fragment>
</Wix>
